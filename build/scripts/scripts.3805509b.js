"use strict";var app=angular.module("app",["ngAnimate","ngCookies","ngResource","ui.router","ngSanitize","ngTouch","pascalprecht.translate","angular-momentjs"]);angular.module("app").run(["$rootScope","$state","$stateParams","$location","$cookieStore","$http",function(a,b,c,d,e,f){a.$state=b,a.$stateParams=c,a.globals=e.get("globals")||{},a.globals.currentUser,a.$on("$locationChangeStart",function(b,c,e){-1===$.inArray(d.path(),["/login","/register"]),a.globals.currentUser})}]).config(["$stateProvider","$urlRouterProvider",function(a,b){function c(a,b){return"components/"+a+"/"+b+".view.html"}b.otherwise("/home"),a.state("home",{url:"/home",templateUrl:c("home","home"),controller:"homeCtrl",controllerAs:"home",data:{title:"Square panda"}}).state("login",{url:"/login",templateUrl:c("user/login","login"),controller:"loginCtrl",controllerAs:"login"}).state("register",{url:"/register",templateUrl:c("user/register","register"),controller:"registerCtrl",controllerAs:"register"}).state("forgot_password",{url:"/forgot_password",templateUrl:c("user/forgot_password","forgot-password"),controller:"forgotPassowordCtrl",controllerAs:"forgot"})}]);var app=angular.module("app").config(["$windowProvider","$translateProvider",function(a,b){b.useStaticFilesLoader({prefix:"assets/i18n/",suffix:".json"});var c=a.$get().navigator.language?a.$get().navigator.language:a.$get().navigator.browserLanguage;c=void 0===c?"en":c.toLowerCase(),b.preferredLanguage("en")}]);angular.module("app").controller("appCtrl",["$scope","$translate",function(a,b){}]),app.directive("modal",function(){return{restrict:"EA",scope:{title:"=modalTitle",header:"=modalHeader",body:"=modalBody",footer:"=modalFooter",callbackbuttonleft:"&ngClickLeftButton",callbackbuttonright:"&ngClickRightButton",handler:"=myHandler"},templateUrl:"common/app-directives/modal/modal.view.html",transclude:!0,controller:["$scope",function(a){a.handler="pop"}]}}),app.directive("dob",function(){return{restrict:"EA",scope:{source:"="},templateUrl:"common/app-directives/dob/dob.view.html",transclude:!0,controller:["$scope",function(a){function b(a,b){return new Date(b,a,0).getDate()}function c(a,b,c){return a+"-"+b+"-"+c}a.days=a.dob?b(a.dob.year,a.dob.month):30,a.dob={},a.dob.year=1,a.dob.month=1,a.dob.day=1,a.months=[{id:1,name:"January"},{id:2,name:"February"},{id:3,name:"March"},{id:4,name:"April"},{id:5,name:"May"},{id:6,name:"June"},{id:7,name:"July"},{id:8,name:"August"},{id:9,name:"September"},{id:10,name:"October"},{id:11,name:"November"},{id:12,name:"December"}],a.getYears=function(a){var b=(new Date).getFullYear(),c=[];for(a=a||1980;b>=a;)c.push(a++);return c},a.getDays=function(){for(var b=[],c=1;c<=a.days;)b.push(c++);return b},a.$watchGroup(["dob.year","dob.month","dob.day"],function(a,b,d){a[0]&&(d.source=c(d.dob.month,d.dob.day,d.dob.year)),a[1]&&(d.source=c(d.dob.month,d.dob.day,d.dob.year)),a[2]&&(d.source=c(d.dob.month,d.dob.day,d.dob.year))})}]}}),app.controller("homeCtrl",["$scope",function(a){console.log("Error")}]),angular.module("app").factory("homeFactory",["$q","$http",function(a,b){var c={};return c}]),app.controller("loginCtrl",["$scope","$location","AuthenticationService",function(a,b,c){function d(){var a={};return a.identifier=f.data.email,a.password=f.data.password,a}function e(){var a=d(),c=function(a,c){f.service.SetCredentials(a),b.path("/")},e=function(a){alert("Error")};f.service.loginApi(a).success(c).error(e)}var f=this;f.scope=a,f.data={},f.model={},f.service=c,f.scope.dob="",function(){f.service.ClearCredentials()}(),f.scope.submitForm=function(){f.scope.submitted=!0,f.scope.signinForm.$valid?(e(),f.scope.signinForm.$setPristine()):f.scope.timeout(function(){angular.element(".custom-error:first").focus()},200)}}]),app.controller("registerCtrl",["$scope","$location","AuthenticationService","UserService",function(a,b,c,d){function e(){var a={};return a.firstName=g.data.firstName,a.lastName=g.data.lastName,a.email=g.data.email,a.password=g.data.password,a.mobileNumber=g.data.mobileNumber,a.dateofBirth=g.data.dateofBirth,a.gender=g.data.gender,a.role=g.data.role,a.grade=g.data.grade,a.schoolName=g.data.schoolName,a}function f(){var a=e(),b=function(a){console.log(a)},c=function(a){console.log(a)};g.service.Create(a).then(function(a){a.success?b(a.success):c(a.message)})}var g=this;g.scope=a,g.data={},g.model={},g.service=d,g.scope.dob="",g.scope.submitForm=function(){g.scope.submitted=!0,g.scope.userForm.$valid?(f(),g.scope.userForm.$setPristine()):g.scope.timeout(function(){angular.element(".custom-error:first").focus()},200)}}]),app.controller("forgotPassowordCtrl",["$scope",function(a,b,c){function d(){var a={};return a.identifier=login.data.email,a.password=login.data.password,a}function e(){var a=d();c.loginApi(a,e);var e=function(d,e){response.success?(c.SetCredentials(a.identifier,a.password),b.path("/")):FlashService.Error(response.message)}}var f=this;f.scope=a,f.data={},f.model={},f.scope.submitForm=function(){f.scope.submitted=!0,f.scope.signinForm.$valid?(e(),f.scope.signinForm.$setPristine()):f.scope.timeout(function(){angular.element(".custom-error:first").focus()},200)}}]),angular.module("app").factory("AuthenticationService",["$http","$cookieStore","$rootScope","$timeout","UserService",function(a,b,c,d,e){var f={},g="http://ec2-54-159-195-71.compute-1.amazonaws.com";return f.loginApi=function(b){return a.post(g+"/user/login",b)},f.SetCredentials=function(a){c.globals={currentUser:a},b.put("globals",c.globals)},f.ClearCredentials=function(){c.globals={},b.remove("globals")},f}]),angular.module("app").factory("UserService",["$http",function(a){function b(){return a.get(k+"/user").then(h,i("Error getting all users"))}function c(b){return a.get("/api/users/"+b).then(h,i("Error getting user by id"))}function d(b){return a.get("/api/users/"+b).then(h,i("Error getting user by username"))}function e(b){return a.post(k+"/user/register",b).then(h,i("Error creating user"))}function f(b){return a.put(k+"/user/"+b.id+"/edit-profile/",b).then(h,i("Error updating user"))}function g(b){return a["delete"]("/api/users/"+b).then(h,i("Error deleting user"))}function h(a){return a.data}function i(a){return function(){return{success:!1,message:a}}}var j={},k="http://ec2-54-159-195-71.compute-1.amazonaws.com";return j.GetAll=b,j.GetById=c,j.GetByUsername=d,j.Create=e,j.Update=f,j.Delete=g,j}]),angular.module("app").run(["$templateCache",function(a){a.put("components/home/home.view.html",'<div class="container"> <div class="jumbotron"> <h1>Square panda home page</h1> <modal my-handler="modal" modal-body="body" modal-footer="footer" modal-header="header" data-ng-click-right-button="myRightButton()"></modal> <a href="#{{modal}}" role="button" class="btn btn-success" data-toggle="modal">Launch Reusable Modal</a> </div> </div>'),a.put("components/user/forgot_password/forgot-password.view.html",'<div class="container"> <div class="col-lg-12 well"> <form name="signinForm" ng-submit="login.scope.submitForm(signinForm.$valid)" novalidate> <h2 class="form-signin-heading" data-translate="user.login.sign_in"></h2> <div class="form-group" ng-class="{ \'has-error\' : (submitted && !login.data.email) || (signinForm.name.$invalid && !signinForm.name.$pristine) }"> <label data-translate="user.email">Login*</label> <input type="email" name="email" class="form-control" ng-model="login.data.email" placeholder="{{ \'user.email\' | translate }}" required> </div> <button class="btn btn-lg btn-primary btn-block" type="submit" data-ng-disabled="!login.data.email || !login.data.password" data-translate="user.login.sign_in">Sign in</button> </form> </div> </div>'),a.put("components/user/login/login.view.html",'<div class="container"> <div class="col-lg-12 well"> <form name="signinForm" ng-submit="login.scope.submitForm(signinForm.$valid)" novalidate> <h2 class="form-signin-heading" data-translate="user.login.sign_in"></h2> <div class="form-group" ng-class="{ \'has-error\' : (submitted && !login.data.email) || (signinForm.name.$invalid && !signinForm.name.$pristine) }"> <label data-translate="user.email">Login*</label> <input type="email" name="email" class="form-control" ng-model="login.data.email" placeholder="{{ \'user.email\' | translate }}" required> </div> <div class="form-group" ng-class="{ \'has-error\' : (submitted && !login.data.password) || (signinForm.name.$invalid && !signinForm.name.$pristine) }"> <label data-translate="user.password">Password*</label> <input type="password" name="password" class="form-control" ng-model="login.data.password" placeholder="{{ \'user.password\' | translate }}" required> </div> <div class="checkbox"> <label> <input type="checkbox" value="remember-me" data-translate="user.login.remember_me"> Remember me </label> </div> <div class=""> <a href="#/forgot_password">Forgot password?</a> </div> <button class="btn btn-lg btn-primary btn-block" type="submit" data-ng-disabled="!login.data.email || !login.data.password" data-translate="user.login.sign_in">Sign in</button> </form> </div> </div>'),a.put("components/user/register/register.view.html",'<div class="container"> <div class="col-lg-12 well"> <form name="userForm" ng-submit="register.scope.submitForm(userForm.$valid)" novalidate> <div class="form-group" ng-class="{ \'has-error\' : (submitted && !user.name) || (userForm.name.$invalid && !userForm.name.$pristine) }"> <label data-translate="user.first_name">First name*</label> <input type="text" name="firstName" class="form-control" ng-model="register.data.firstName" placeholder="{{ \'user.first_name\' | translate }}" required> <p ng-show="(submitted && !user.name) || (userForm.name.$invalid && !userForm.name.$pristine)" class="help-block">You name is required.</p> </div> <div class="form-group" ng-class="{ \'has-error\' : userForm.lastName.$invalid && !userForm.lastName.$pristine }"> <label data-translate="user.last_name">Last name</label> <input type="text" name="lastName" placeholder="{{ \'user.last_name\' | translate }}" class="form-control" data-ng-model="register.data.lastName" ng-minlength="3" ng-maxlength="8"> <p ng-show="userForm.lastName.$error.minlength" class="help-block">Username is too short.</p> <p ng-show="userForm.lastName.$error.maxlength" class="help-block">Username is too long.</p> </div> <div class="form-group" ng-class="{ \'has-error\' : userForm.email.$invalid && !userForm.email.$pristine }"> <label data-translate="user.email">Email</label> <input type="email" name="email" class="form-control" data-ng-model="register.data.email" placeholder="{{ \'user.email\' | translate }}"> <p ng-show="userForm.email.$invalid && !userForm.email.$pristine" class="help-block">Enter a valid email.</p> </div> <div class="form-group"> <label data-translate="user.password">Password</label> <input type="password" name="passsword" data-ng-model="register.data.password" class="form-control" placeholder="{{ \'user.password\' | translate }}"> </div> <div class="form-group"> <label data-translate="user.register.confirm_password">Confirm Password</label> <input type="password" name="confirmPassword" data-ng-model="register.data.confirmPassword" placeholder="{{ \'user.register.confirm_password\' | translate }}" class="form-control"> </div> <div class="form-group"> <label data-translate="user.register.mobile">Mobile Number</label> <input type="text" name="mobileNumber" data-ng-model="register.data.mobileNumber" placeholder="{{ \'user.register.mobile\' | translate }}" class="form-control"> </div> <div class="form-group"> <label data-translate="user.register.dob">DOB</label> <dob data-source="register.scope.dob"></dob> </div> <!--\r\n              <div class="form-group">\r\n                  <label class="col-xs-3 control-label" data-translate="user.register.gender">Gender</label>\r\n                  <div class="col-xs-9">\r\n                      <div class="btn-group" data-toggle="buttons">\r\n                          <label class="btn btn-default">\r\n                              <input type="radio" name="gender" data-ng-model="register.data.gender" value="m" /> {{ \'user.male\' | translate }}\r\n                          </label>\r\n                          <label class="btn btn-default">\r\n                              <input type="radio" name="gender" data-ng-model="register.data.gender" value="f" /> {{ \'user.female\' | translate }}\r\n                          </label>\r\n                          <label class="btn btn-default">\r\n                              <input type="radio" name="gender" data-ng-model="register.data.gender" value="other" />  {{ \'user.other\' | translate }}\r\n                          </label>\r\n                      </div>\r\n                  </div>\r\n              </div>\r\n            --> <!-- File Upload need to create as directive --> <!--<div class="form-group">                        \r\n                <label data-translate="user.register.profile_picture">Profile Picture</label>\r\n                <input type="file"  class="form-control">\r\n              </div>--> <div class="form-group"> <label data-translate="user.register.role">Role</label> <input type="text" name="role" data-ng-model="register.data.role" placeholder="{{ \'user.register.role\' | translate }}" class="form-control"> </div> <div class="form-group"> <label data-translate="user.register.grade">Grade</label> <input type="text" name="grade" data-ng-model="register.data.grade" placeholder="{{ \'user.register.grade\' | translate }}" class="form-control"> </div> <div class="form-group"> <label data-translate="user.register.school">School Name</label> <input type="text" name="schoolName" data-ng-model="register.data.schoolName" placeholder="{{ \'user.register.school\' | translate }}" class="form-control"> </div> <button type="submit" class="btn btn-primary" data-translate="common.buttons.submit">Submit</button> </form> </div> </div> '),a.put("common/app-directives/dob/dob.view.html",'<div class="row"> <div class="col-md-4"> <select class="form-control" data-ng-model="dob.year" data-ng-options="year for year in getYears()"> <option value>Year</option> </select> </div> <div class="col-md-4"> <select class="form-control" data-ng-model="dob.month" data-ng-options="month.id as month.name for month in months"> <option value>Month</option> </select> </div> <div class="col-md-4" data-ng-model="dob.day"> <select class="form-control" data-ng-model="dob.day" data-ng-options="day for day in getDays()"> <option value>Day</option> </select> </div> </div>'),a.put("common/app-directives/modal/modal.view.html",'<div id="{{handler}}" class="modal fade"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h4 class="modal-title">{{header}}</h4> </div> <div class="modal-body"> <p class="text-info">{{body}}</p> </div> <div class="modal-footer"> <h4 class="text-warning">{{footer}}</h4> <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> <button type="button" class="btn btn-primary" data-ng-click="callbackbuttonright(); $event.stopPropagation()">Launch Alert</button> </div> </div> </div> </div>'),a.put("layout/footer.html",'<div class="footer"> <div class="container"> <p><span class="glyphicon glyphicon-heart"></span> square panda</p> </div> </div>'),a.put("layout/header.html",'<div class="header"> <div class="navbar navbar-default" role="navigation"> <div class="container"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#js-navbar-collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="#/home">Square Panda</a> </div> <div class="collapse navbar-collapse" id="js-navbar-collapse"> <ul class="nav navbar-nav"> <li ng-class="{active: $state.includes(\'home\')}"><a href="#/home" translate="nav.home.title">Home</a></li> <li ng-class="{active: $state.includes(\'login\')}"><a ng-href="#/login" translate="nav.login.title">Login</a></li> <li ng-class="{active: $state.includes(\'register\')}"><a ng-href="#/register" translate="nav.register.title">Register</a></li> </ul> </div> </div> </div> </div>')}]);